#[derive(Clone)]
enum Cucumber {
    EAST,
    SOUTH,
}

static INPUT: &str = "v>.>>v>.v>.v.>...>>>.>>v..v>v>vv.>>>.>>..vv>>>.>>.v..v..>....v....>.v>...>..v..v.>..>>.>..v.vvv...>>>>>.v...>>>>>.>v.v>>.v>..>..>.>>..>>>>>
..v>v.vvv....vv.vv.v..v..>>>>...v...>..>>......v>.>.vvv.>v..>..v>...>>.......v>>.>v>.v.>>.>>v..v.v.>>>v...>v....>.>.>...v.>..>.v.v>v>v..v.v
>vv...v.>.>.>v.vv>.>.vvv>..v...v.v.>...>.v>..v.v...vv>>.>v.>.>>....>>...>.vv...v>.v..>>..v.>vv...>v...>>...v..v.v..v>.v>v...v.v..>..>.v>v>.
..v>>.vvv..>>v>>.v>.....>>>.v...v..v.>......>>........vv..>.v>v.>v.v>.vv.vv>..vv>.>..v.........vv..>vv...v.>..v>.>.>>>..v.>v.v.....v.>>v.v.
.>.v>..v.vv>..vvvvv..v..v...>v.>v..>..>>..v>.v>....>..>>...>.vv.v>.v.v>>.v>vvvvv>>v>v..>...>..vvv..>v>.v>v.v>...vv.vvvv>.vvvv...v....>>v.>v
.v.>v..v.>.v>v>....v..>>v.>vv>.>>v>..v>..v>v.v.vv>..>v>.>.v.v.vv.v>>.vv.>..v.vv>>v.>....>.>.>v.vv...>....>..>>v.>.v.>v....v>.v>....>>v>.v..
>>..vvvv..>v..v..v>..>.>.>...>>.>>>v.>.>.>....vv...vv.....>..>v..v.v..>>>>vv....>v.>.v..>vv...v>v...>..v>....v.v.>....>.v.>.>...v.vvv>vv>..
.v..v..v..v..>v.>>>>...>..>......>v.v>>>.>....vv....v>>v....>.vv.>>.>v..v..>.v...vv>vv.>>>.vv>>>.>.vv.v>v.>...>...>..v>v.>>v..>..>v.>....vv
.>.v.>.vv.v.>...>...v.v>.v.>.>>v.vv>.....>.>vv..v..>v.>v>vv.>.>.vv...v.v>.....>.>v..v..>.>v.....>..>..>..>v..>.>.v.>v.vv...vv>v..v..>.v>...
v...>>...vv....vv>.v.v.>>..vvv>>v...v.vv.v.v.v.>..v..>....v>vv>..>vvv>>..v>>>>.>.v...v>..>v.v.>..>v..>v>vvvvvv.v....v.>...>.v.v....vv>...v.
v........>v.>..v..>...v.v>.>.v.v...vvv>...>..>v.vv.....>>.>>>..v.....v>..>.v.>v>vv>.>vv..v.v>.v....v>...v.>>>>...v.v>>..v...v.vv.vvv...v..>
v>.>.v>v.v.v>>v.....>..v.v>.v.v.>..>v>vv...v.v.>>vvvvvv.v..vv......>v>v.vv>.>v.>..v>vvv.>>v.v>.>.>.v...v...v.>.vv..>.>vv.vv.>>>>>v.>v.....>
v..v.>v>vvv..>.>..>.>>....v>.vvvvv..>..v..>>..v>..>>>vv..>>.v.>......v..v.v.>..>>v...vv>>.v..>..>v>v..v..v>.>.>.v.>...>>>...v........>.>v>v
v.>v>.....vv..>vvv>>.>.v.>v.>v.vvv.>>>>.....>...v...>...v.....v..v.v....v>.>>v..v>.>.v..v.......>v...v.>..v..>.>.>>>...vvv>..v>>.vv>.v.>..v
v..>.v.v..v...v.>.>.>.>.v...>.v>.v.v>...vv.>.v.....>....>....>v>......>.>..v..v.>...v.>..v...>>>.>>....>.v>.v>v>v>>.v>.v>v>..v.v.v..>>.....
v>.v>.>>>>....v.>.v......>>v.>vv..v.>..>.....>.v>....>.v.vv>v>.>v.>.>>vvvv.vv.v>.>.......>...>>.v>vv.v..>v>...>.vv..vv>v>..vvv>...>......>v
.>>v..>>..v..v..>...v.>v.>.>.v......>..>...>v.>.vv>...>vv>v..v..vvv.>v>..v..v>>.>>.v..>..>>>...vvv..vv.>.v.vvv>...v>>.v.>..>vvv>.v.v..v....
v..>...v.vv>vv.>>v>>.>.v....vv>vv..v>.>.....vvv..>.>...vv.vvv.vvvv.v>.>...>..>v..>....>...v..vv>>v>>......v..>..>.>vv...v>...>..v.........v
..........v...>.....v..>..>>.>>.....>...>..>.vv>.>.vv..>v.v...>>.vvv...v..v>..>v>..>.>vv>>v...>.v.>.>>.v.....vvv>...v>vv.>vv>>.v>...>.>v..v
..>.vvv..>.vv..vv>vv.>...v>>.v..>.vv.>>v>v>v.v.>v>..>>.>.vv..v>.v....v.v.>v....vvv.vv.>v>..>.vv>.>.vv.>.>.>v..>>.v.v.>>.v....>.>>>v.>v.>.vv
v>v.>>.>>.>.>.>.v>.v>..>.v>v>>>vv.>vv...>>.>>vv>...v.vvv..>.>v..v..v.vv>v.v..>...>.v.vv....>.......>.v..>....>..>v......v........>>vv.v.>..
....v.>vvv...>v..>...>v.v>>.vv.v..>>>..>v.>v.vv.>..>v>.....v.>>...>..v>>.v>>>.....>.v..>v.v...>v.v>>>>..v>>>v.v>v..v>vv..>..>v>..v.>v>v.>>v
.>...>..>>>v.v...>v..>.v..vv..>....>....v..>vvv.>.v..v>v.v.>vv...v>v...v.>..v>v..v..vv>>vv.....>.v>>...vv...v...>.>vv.v>..>v>vv....v.....v.
...v>v>v>v.>..>..v.>..>..v..v....v..v..v>...v.>vv.>>v.>.>.v...vvv>...v>....>v...>>...v>v.>v....v>>..>v.v>.>v.v..>...>>...>>>..vv.>..v.>..>.
.vv>.>v..>vvv..>.>>v.>.v.>.>>vv.>..v.v.vv>v.vvvvv>.v.>........v>vvvvv....vv>.v...v.>....>v......>>.>.>>v.>>..v.........>v.v.>....>....>>v.v
>>.v.v.>v.v>.>.v>..>vv..v.>v.>>>..>.v>.>.>.v.>>>v>...>vv>.vv>...>>v.v>.v..v.....v.v........v.>.>>..vv.v>.v...vv>vvv>v...v...v>>vv.>.v..>>..
vv.v>.v>v>>>>.........>.v>..v>....vv>.v>..v..v..>.v>.v..>>..>>..v.......vv>>>v.v..>..>>v>..v...>.v..vvv.>vv.vvvv>>.v.v...v.>...v.v>>v>.>vv>
v......v...>.v>v....v..v.>..v>>.>.>vv.vv.vv>v.>.v>v>v>v>>..>vv>vv..v..v.>..>>.vv>v..>>v.v>v.vvv>.....>>..v>>v......>>>.>vv>.>vv...>>..vv...
v..vv.>....v..v......>.v.v...>v.v.v.>..v>.>.v.v.>>>.>>>.>..>.v..v.v>..v.vv.v.>vv>>v>v.v>v....>v...>..v.v..v..>..>.v.>v.>>..>vv..vv..v>>>>v.
v...>>v..vv>.vv...v.v>>>vv>v.v.....>...>v.v>..v.vv..>>>v..>>v.>vv>.v>...v.v.v....vv>>vv>....vv.>v.v.v.>..>..>.>v>..v>...vv>v.>v>>..>>>>.v.v
..v..v.v..v.v>...v>v.>>.>>>v>v...vv>....v...>v...>.>>....v>v...vvv.v>...>v.....>v...>v>..>>>v.>.>.........v>..>>>>>....v..v..v...v.vvvvv>>>
.>v...v......>v.>v.v>v>...>v>.v>>.>.>..v..>v.>v>....>>v....v.v..v>..vvv.v>.v>...>.v>.vv.vv....v...vv>>.>.>..>.>....>..>>>v.>vv>.>>..>>...v.
..vv.>...>.v>.>>vvvv.v.v>>..>.>>v...>...v.....v.vvv.>>>vv...>...>..>.v.v.v....v.v.>..>vv>...vvvv..>v>>.>.vvv>..vv>>v....v>...>..v...v.vv...
..v...v...>>>..v..v.v>..v...>>.>v....>.v>>.>>v....vvv..vv.>>..>..vv.v.>>v>>>v...vv...>v..v.v.v.>.>v.>.v.vvv>v..v....vv..>...v..>vvv......v.
>.v.>v>vv>....>..v>..>..v.>....>.v.>>v.v....v.>v...v>>...>v......v>>v....vv..v>...v.v>vvv.v.vv.>.>>..>..v.>.>>>.v>>..v>v>>v>>v>>>>.>..>v...
vv....>>v>v...>v.>v>.vv>vvv>v..>.>.vvv.....>v..>...v.>>......v>.>>..>..vv.>v.>v..v..v...v>>v.>.....>....>vv.>>>>>>.>>>.v.v....v.v>v..v>v.vv
>v.>.>.vv.vv>.>.v>v..v.>........v>>>...vv..vv...vv...>.>vvv>.v>v>vv>.>v>.>.v>v>>.>..v.v.>>>>>..v>>vv.>.>..vv>v..>>v.v>..>..>...>v>.>.vv>>..
v..v..v..>......>>>v..>.v........vvv>v>v.>>v.v>....>..>.>>.v..v.>v.>v>v....v>v.>.v.>.>.>..vv>..>..v.v>..vv.v.>..v......v>>.v>....vv.>>>vv>.
....v..v.>vv>.>.v....vv>..v.>v..v..>.v.vv.>...>..>.v.v.vvvv.>v>..v>.>v.>>....v....>>>...v..v.v......>.>vv>.v>..vvv.>.>v>.>.>vv..>.vv.vv.v.>
>......>vv.vv..vv..v.vv.>>>v..>v.>.v..v..>.>.>>.v>..>>...vv>>...>.v.v.v>.>vv.>.v.v>.>.>>>..>>...>v....v.vvv.vvv...>>>v>>v..vvv.>>>>v>...v>>
.v>>.>.>v.>..v.>>.vv.v..>.....>.>v>vv..v.v....>v>..v>....>.vvv.>.>v....>vvvvv>>......>vvv...>.v.........>..v..v.>>vv...v.v......vvv.vv>.>v.
>...>v>.>v.>..v.v>..v>v..v.v.....>v>..v...>..>v.v..v.>vv..>.>v.vv.>>>..>.>v>vv>>v.>..>>.v>.>v....v.>>>>v>>>>>v.v>>>...vvv..>....v..vvv....v
.vv.>..>.....v.....>.v>v>.v.....>....vv.v..>>>vv..>.v......>vv>v.v>..v..>>>.vv>.vvv..>v>>.v..>..>..>>.....v>>....>..v.v>.v..vv.vv.v>v...v..
.>v......>.>vv>..>.v.>.>v....v>...v..>..v>.>.v.v.v.v>>>v>.vv.>.v.v.>>>...>....>..>..>vv>>.>...v.>>.v>.v.v.v.>.....v.vv>..v>.vv.....>...v>v>
..v.>.v>v..>.>.>....v..>.v..>.v>.vv>>.>>..>>v>.v..>..>.>.v.>>.>v>v.vv..>..>..>>.>>.v.>>..v..>v.......v.>>..v>.>..v>.v>>..vv...>..v...v>>vvv
.>..>.v..v.vv>>....v...>>v>>...v..v.>...>v..v...>.v>>......>.>v.>...v..v...>v.v>......v....>>.....>..v.>>.v.v.v.>.>>>...vv......v>...>.vv>.
.v.>v.>.>..>v>..>.vv.>.v...>>.v.>....>>v>......>.>v.v.v.vv..>>v.v.>>.v.>v>>.v>.>...>..>.v>..>..v....>...vv.v.>>........v>>.......>>.vv>..v>
.v>v.>v>..v..>v.>.vv.>v>>v>>....vv>....>>>>.>.>>v..>v...v>>......vv>v.>vv.vv..>.v.>...>>.>vv>.>..>.....v.v.v..vv....v>..vv>>v..>vv.....>vvv
.v>v...vv.>v......>....v>>..v>.vv...vv>..>.>v>..>.>..vv>>...>vvv.>..>..vv.v...v.vv>v.>>>>v.....v.v>..v....>...>.v>.vv.vv.>>.>...v..>vv>.>>v
.>.v>>v..v.v.v..v.>....>.v>v.v...vv.>.>v..>v>>v.v.v>.>v>.>v..>.>.>v.v>vv>>.....>v....v>>>vv.v>>..v.>.>>>...>vv>v.v..v>....vv>>.>>>.......vv
.>.v>.vvv.v.vv....>..vvv.>..vv.v>..v>.>vvvvvv..vv..v.v>>...v...v.v....>>>>>>.>....vv>v.v.........>vvv.v>>>.v>.vv>>..v...>.v...>v>v>.v....v>
>.v>v.v>...v.v.vv.>>>.vv.vv>.>....v>.vvvv.....v.>.....>....>..vv>v..v....v.v.>.>.v...v.vv>...>v.>>..v...vvv...v..v.....>vv....v>v.v...v>>vv
v.>v........>....>v>v.v..v......>...v..v.>v.v..>.>vv>v...>>>.v>.>..>v>..v..>v...v>.v.>.v..>v>.....>>v.>.>v.v..v.......>.>.>...>v.v.v.v.vvv.
.>...>....>...v>..v...v>v>>..v>>>.>.>>v>vv.>>vv>.>v..>.>.>>v>>vv.v.v..v..vv.v..>.>..v>vv...vv>..>...>v.vv>>...>.>..>..v>...v>>v>.v>...v....
v>>vvv..v...v....>..>...v>.>vv....>..v...>>....v.>.>.>.v....vvv.vvvv>.>..>v>..>.....>vv.vvv.>>>...v.>.vv.v.v>>...vv>...v...v.vv.v.v.>>v..>.
vv.vvv>.vv>..v..>v>..>..v...v>vv.>....v.....>.>...vv.>vv>.>>.vv..>v>>...>.>>>v.vv>......>.>.v>v>>..vv..vv.>>v>>....>.vvv>v>>...>>.>.>>.v>v.
...>vv.>..>..>..v.v.v>.vvv..>v>....>.v>>..>vvv.>v.v.>.v....vv.>....v>>>v>>.>v.>.>v>>.v..>v>....vv.vv>.v.>....v..>>v..>vv>.v.>>..>........v>
>.>.>vv>v..vv.>..vv..>vv..v..v.v>.v.>.>>vv..>v....>..>v>>..v.>>>vv....v>v>>>..v.v>>v>.....>>>.v...v>.v>.v>v..>>vvv..vv.vv.>vv..v..>.>v.....
>.v>.v.vv>.>...v>...>.vv..v.>v...v>.vv.>...>.v..>v.>.......vv...>vvv.vv.>.v..v.v..>v>>.v>>.>v.>..v.>....>..v>v....>>....v..>.vv...>v..>>...
..>..v>>..v>vv.>.v>.v>..>.vv.v>....v...>>.>vv>v......v....>.>.>>..v.vv>.>v.>>>..>....>..v>>...>..>..v.vv.v.vv.v..>...>>..vv...v...>.v>....>
.>..>v.>.>v.v..>...v..v..>v>...v..>v..>vv.>.v.>v>..v...>>v>v...>>>>.vv>>.>v>.v>.>.v.v.>vvvv.>>..v...vv>.>...v.vvv>.>>..v.v>.v>v....>.v..v.>
v>>>.>.v.v..v>.>....>>.>>>>>v>..>>>.vv>v.v.vvvv.>>>v>>>>v>...>.>.>.vv.v...>vvv..>.v.v..>.v>..vv>>v.>.......>.vvv>vv>v.v>v>>v.>....>vv>...>v
..>..v....v..vv..v..v.vv..>>>.>..v>>..>.>vvv.v..v..v.>..v>........>.v.v.>>>......>..v>>>.>v>.>vv..>v>v......vv>>>>.>v.>v.v>.>v.>.>.....vv..
>.>.>v>>.v.v.>..v>>.>v...>...v.>..v>....>vv.>>..>...vv>...>..>v.v.v.vv>.>v.>.>.v.......>>>v>>...>..>v>>vv>.>.>v>v.>...v..>>..>v>>v..v..vv>.
.>vv>v.>>...vv..>v..v>>>v.v.....v>.....v.>>.......>..v.v>...>vv...>.vvv.v>..>v....>.>..>...>..v.......v.v....>>...>..>....v.vv..vv.v.>..>.>
v.......>...v.>vv......>..>v>vvv>...>vv.>v>>.>v.>.>...>.....>....>.....v>.>.....>>v.>>>..>.>..>.>..>v>.vv..v.v...>>>.>.vv.>>>v...v...vv>..>
..>.v.v.v......v.>>>v.>..>v>>.>>v....>vv....v>.v.vv.v...>v>v...v.v>>.v..>>.>.>.>>v>v>>.>....v>..>..>.v>vv..>....>....v.v...v>..>>>>v....v>.
.vv.>..>.>>>v.>.v>...>..>>v.>........>>>>.>.>v.v.>...v..>..>v....v..v>....v.....v.v.vvv..>v.v>....vvv...v.>..vvv...v.>>v.>..>>>>.>..v>.>..>
vv.>...>v.v>v.>>...v.>vv..>.v...>.>>>v.>.v...v...v.v.v..v.v>.>.vv>.>v....v...>..>v>v>.v..vv.>..vv.>...>vvv.vv....v.v>>..v.>.>v..v..>.>.v>.v
>..>v..>v>vv>v..vvvvvv.>>.>...>...>v....>....>>>>>.v.v.....>v.vv>>>v..v..v.vvv..>v.>vvvv..>v>...>vv.v.>.>.>>>.vv.>>>.vv.>v..vv>>v.vvv.>v>>.
.vv>..>>>..v.>...v>vvvv.v.>vv....v...vvv..v>..v.vvvv>>.v.v.>>.>.v.>>..v.v..>..>>>.vv...>.>vv.v>>v..>..v.vv.>vv...>v.vv>..>v.>..>vv>.>....v>
v.>>...>.v>>......v.....v.v.>v.vv>>>...vv.>>v.>.>..>>...>..>.....>....>.v.v.v.>>vv..>>..>...>v.>..>>>.....>>v>>v>..>.v....v......>vv...v.vv
.......>...vv.vv.>..>v.vv>....>>vvvvv>>...vv...v.vv...v>vvv.v>.>>...>>v>..v.....>.>....v......v.v.>...v......>>>...>v>>>.........>..v.vv.v.
v.>......v.>v...>.v..vv.v.>.>.>>>...v.v>>...>.>>>>..v.vvv...v..>>vv>.>v>...>....v>>>v...v...vvv..>.>......v>.......>.v.>v..v.vv....v.v.....
vv..v..v...vv>.>.v.v....v...v..v.vv.v..vvvv..v.>>v.v...>..vvvv.vvv>.v>v>vv...v>.....>.>v>>..v....>.>.v.v.v>vv..>>>v>...vvv>>vvv>.>..v....>.
vv>.>..>>....v>....v>v..>..>..v.>v....>>>..>...>...>.vv.v>.v.v....>v>>.>......>v..>..>v....>v>v.....>>v.v.>v..vv.>....v.>...>.>v>v.......v>
>....>>...>>..>.v.>v..v>v>>.>>.>>.v>>>vvv..>.>.vv..vv...>..>>.....>...>.v..>.>v..v...>>>>.>v..v.>..>.....vvv..>.vv.v.v...>>v.>..v>v..>>v...
.v.>vv>.>.v.>.v.v..>.>>.>vv>v>.>...v..vv>>v.vv.v......vvv>...>.v>.>.v..>v..>.>>>.>..v.v.v..>.....v.vv>.v>v>..>vv>>>......>v.vv>.....>.v.>>v
....>....>.v.v.>>vv>.vv.>v.v..>>>.>..v.>>v..>v.>>..>...v>.>>>..>....v.>..vv>.>.v..v..v>.v>>.v.>..v>v....v>v..>...>v.>v.>....vv.>.vv>.>..>>>
v...v>>.v>>...vvv>...v>...v>vvv.v.vv.>vvv...vv.>>>v..vv>...v>>.>v.>>.....vv.>>.v>v....>........v..>...v.v.v>v>.v>v....v>..>v.v.>..v.>..>.>.
.vvv>..>.>vv..v...>..>..v.>>..>..>.>v>.....>.v>>>.>.v..>..>.>v..>..v>>.>.....>v....>>.v.....v>..>vv.....v.>.>.>>v.>.vv>...v.>>>.v.>vv...>v.
..v.>..vv>>>vv>>.v.>.>..v....vv>v..v......>v...v..>.vv...>>....v...>>v..v..v>v..v.>.>..>>>..v..v..v.>>>>.>.>.>.>.vv.....>vvv>v..>v...>.v>v.
..>.v>..vvv..>..v>v.v.v.v.v>.>.>..v>...>v.>>>>>v..vv.v>.>.>>.v....>..vv...>v.....v>..>>>>...v>..vv......v>vvv>>>v.v..>>.v.>..>..>..v..vv>vv
>>..>..>vv...>>....>.>v..v..>..v>vv..>.>>>.....>...>.vvv.v>v..vvv.>.vv>...>vvv..>v.>.>>..v>.....v.v.vvv.vvv..>v..v>>...>.vv..v>>.v>v.>...>.
v..>>...vv..>.>.>>.vv..v>>.>.v....>..vvv>>..>v..v>..>v....>v.>v...>...v.>>>.>vv..>vvv>v.>>.v..>..>>.>.v>.v....v.....>>vvv.vv>vvv...>>.>v..v
....>>>.>.>v..>>..>>...v>>...v.>vv...>v..v.v>v>vvvv.v>.>>...>>.v.>.vv.>>v>..v.>v>>.vv>........v...>..v>vv.>>.v.>..>..>..>.>.v..>v...>...v>v
>v.v>v.v...>vvv>.........vv..v>v.>>...v>.>>vv>.v.v.>v..vv..v.v.>.v.>.v..v>.>>..>.>..v>>vv.v.>v..>..>>v.>>>v>...v..v........>..v......v..v.>
.>....v>.>>.>v.>....>v.v.>.v>.>v>>v.v.>.>>vv.>v....>.>>>>>>...>..v..v.>v.>v.v>v.>.vvv..>>.vv.>...v>.v>>.v.>.....>.v.v.....>.....>>.v.v...>.
.>>......>>>>.>>...>.....v.v.>..>>v>.>v...>..v>....>>.....vvv>>....>..>>...>v..>v>.>>...v....>v>...v>>.vvv.>vv...v..v.>>vv>.v>>....>..v....
>...v..>.v.vv..>...>vv...>>..v>.vvv..v..v.v.vv>vvvv..>v.>.v>>.v>>>>>.>v>>v>.vv>>>v....vvv>v..>.>..>.>.>.vv.v>v.>.vv...vv.v.v.>>.>....v.v>.v
v...v.v.>.>>.>>v.v>..>..v>.....>..v..>v>...v.v.>.>..vv.>.v>v>v.>>v>vv>..>>v..v..v..v..v.vv..v.vv>vv...vv>v.>>v>...>>>....>vv>>v>.>v.v>.>.v>
.vvv>>.v.>vv.v......>vvvv.v.>v..>>.>...>v..>>v..vv..v...>>..v.>..v>>v>..>vv...>.v.vvv..>.>>>>v..v.....v>v>..>.v.v.v>>>>>v.v.>vv>>.v.>.>....
>v>.>v..>>.>.v.v.v>.>.....v...v>.>>.>vvv.>.>>.>>vv>>..v.v..vv>..>.....>...>v.vv>.>....>......>>.....v..>>v.>vv...vv.>v..>>vvvv.>>vvvv..v.vv
>..>..>..>v.vvv...vv>v.>v>v..vvvv.>>.>..v.v.v>>.v.v.v.>vvv......vv>>.>...>.vvv.>v.>vvv>.v..>>.v>vv.vv....>.....>..v>..v.v.>>....v..v>v>.v>v
>...>....vv>.>v>>..v..>v..>>>....vv>vvv>..>..v>..vv..vvvv.vvvv.>.>v>>..>....v.v..v..>v...>.v>>.v..v.v....>v..v>..v>vvvv..>...>>>>.>v..>>...
v>..vv....v>>>.v..vv>...v.>>..v..vv>vv>...>.v>...>>..>vv..>.>.>v.>.v...v.v>>v.>.>v>..>..>>vv>>>.>....>...vvv>v....v.v.vv.>>.>.>v..>.v.>vv..
v>.>.>>...>>>>v...v.>v>v>v>..vv.>>...>v.v.>.v>>.>vv.vvv.v.v.v>.>>v.v.>.vv>.>v>v.v...v.>>v>>v>>v>.v..>>....>>>>vv......vv>>.>vvv....>.vv..v>
vvv..>..v>>..v.vv>v...vv..>vv>>v..>.v.v...v...>.>.>..>.vv.v.vvv>v>.>vv>v.vvv.v>>..>v...v>>>>v>v..>v..>.v>.v>..>>.>vv>v>>.v>v>v.>.>.....>.v.
.>>....vv.>>>>.v..>>>>.v.>.>>...>v.>..>....vv>..>>v......>....>..>>..v.v.>..>.vv>...v....vv.v..>>vv.v.>>v.>.>>....>>>>..v.>>..>.>..v>>.>.vv
>..vv.>..>...>>...>.>>..>v.v..v...vvv..>.>.....>>.>>..vv.v>..>v.>v.v>...v>>>v>...v>>vvv>>v......v>>.v...v.....>>...>v.>v..>>>>.v....vv..>v>
>.>v.>>>.>..v.....>>>v>.>v.>...v..>..vvv....v...>v..>.v>.v.>.v.>..v>>>>...>>...v.>.v...>.>>v.>v.>>..>v>..v..v.>v.>...v..vv.v.v...>.>.....vv
.vv>>..>>.v>.>v...vvvvv....>>v..v.>.v>>.>>vv......>>.>>......v..>.v.v>>.vv>.v.>.v>vv.v.>.v......>>.>.v>.>vv>...vv.v...vv.v>v.>v...vvv...v..
..vv.>v....>vv>>.....v>vv..v>...v>v.>>vv......v...vvvv..>.>>.>>.....v......vv..v>.v.....>v..vvv.v..v>v......vv.>>>>v....vv..>.v>>....>.>v..
.>>v>.>.>.>..>v.>v..>>>vvv>v....v.v.>...>.>..>>>..>.>v..>.v.>>v.v.>.v>..>vvv>v......vv..vv.v...>.v...>>..v...v..v....vv>.>..v.v>vv..v..v.vv
.........>....v.>..>v..v....>.>.vvvv>.>>..v..>....v>>.....v.vv>v..v....>>...>.v..>..>..>.vv.>>>..v>>>>.v..v>>.>.v.>>.>.>v..>.vv>v>>>vvv>.v.
.>.>.>.v..>...v........v>..v..v>>vv.>>.v...>..>....>>.vv..>v.>.v>...>v...>>.v.v>vv.v>>.>v.v>..>>.v>.>.>>..>.....v>v......v.>v>.v...>.>..>..
..>>v..v>>..v>..vv..>>vv>.>>>.v....v.>.>..>..>.v.v>..vvv>vv.>.>v...v>>.v>...>.>v>v.v.>..v.>>vv>..........vv..v>.>v...>>.v>>>..>..>>.>v>..v.
.....>..>..>..>v.vv>.v>.vv>...>>>.>..>>>..>>vvv.>.>..vv....>v.>..v...>>>v.>.vv.>.v.v...v...>>..v>v...v...v.vv.>.>.>.>v>.>v>v..vv..vvv>>>.v.
v...>.v.....>.v>..vv.vv.vv...v>.>...>>.>v..>>vv.v.v...vv.....v>.>vv>vv.>>.vvv>..>..>>......>.>vvvv.>v.vv.....>>.>>vvvv.vv>>..>...vv.>..>>..
>>v.vv>.v...>v.>..v...v.v>>.>..v.>..>>.v>.>.vv>>vvv.v..v>..vv.......vv.>vv..>..>>...>vv.>...>>v.v....>.v>.>>v...>.v>.v..v..v....v>vvv....v.
v>v.>..v.>.v.>.v..v>>>.v.v>.>.v..v.>.>v.v...>v.v.v....v.>..>v.v>...v>.>.>v>>v.....>v...>vv.>v..>...>>>..v.v.....>>v..>.>..>.>..>>v>>v>>v...
...v>>>.>.v>>>..>.vv.v>....vv>vv>v....v...v.v>vv....>>vv.......>.>v>.>.>..>..vv.v>.>>.>.v...v>.>.v.>>..v>.v>.>>.>v..v>....>.v.>..>.vv>.>...
>...>..vv.v..v..v..v..v..vv.>v.v...v..v.v>..v.>.>.>vv>>..vv..v>>>>>..>.v>.vvv.v...>..>>.>v>>v..>..v>.v>.v>.....>v..>>>vv..>.v>.>.......>...
.v>...>>>.v.v..>>v..vv.v.v.v......>>>v.>v.v>..v..v>..>v.vv..>.....v....>>v>>....>...>>v..v...>v....v...v>v..v.>.>.vv.v>>vv....>.vv.v....>.v
.>>.>>v...v.>v>vvv..v...>vv>>>v>v...>.>..>vv..>>>.v>..v>...>vvv.v>v..>.v>v>..>.>...>v....>.v.>....>...v..v.>.v>v...>..v..>v.v.>>>v.>..>v>>.
>...>.>.vvv>>>v.>v.>>.v..vv.v.>>.>v.v..v...>..>>...v..vvv>.v>.....>>>...vv>vvv...>...v.......v>...>..v.>..>>..v>v....v..>v..v...v.v>...>...
>..v.v.>vvvvv....v>>v>>v.>.....v....v...v>..v..v.>.>>....v>..v.v>>....>v......>..>>...>v>.vvv.v.>>>>v.v......v.>v>v......>.....vvv........v
>>.v.>.v..>>.>.>v...v...>.>v>..v>.>v>>.......>....>>>...>v>>v..v...vvv.>...>......>>.vv>..>>>>>...>>v...v..>>.v.>...v...>..>..>..v.>......v
.>.>>v.vv.>>v.....>vv...>>v>.>.v.>.vv.>...v....>...v.vv>.v..>...v>...>..>v...>>.>>....>.v.>.>..vv.>v>...vv...>>.....>vv.v.vv>vvv..>v..>.>..
.v.v>.>...vvvv..>...v>v.>vv...v.v.v...vv.>...v..v>>>...vv.>>...>v...>.v>.v>v..vv>>....vv.>.vv..v.>.>..v.......v.v>v>>.v>>vv>v.>.>...>v.v>v.
>.>v>vv>.>>>....>vv.v..vv>v>v..>..vvvv..vv..>vv.>.v...>.........>vvvvv...>>.v>v>..>v..v>.v.>.>.v..v......>vvvv...v>.>.vv..>>.vv.>>...v.>>..
..v...vv.vvv.>..v....v...v.vv>....vv..v..v..v.vv.v..vv..>>>...v.vv>...>..>v......v.v.vv>>v.v.v>.>v>.v.>.vv.v>v..>....v......vv>>v>>>..>....
..>..vv...>.>vv.>>..>...>v>..v>vv>.>.v>....>.v...>>v...>v....v.>v...>.>>.>.>v..v.vvv...v>>..v.vvv.>>v>v>v.v>..v>v..>>v....>.vv....v.v.>.v.v
v>..v...>..>v...v.v>.v>>vv>..>..v..>..v>>.......v..>...v..>.v..>..v...vv..vv>vv.v..>v...v>v>...>v>vv.v..>.>...v....v..>....v.v...>.......v.
v>.>v.>...v>.v>>..v>...v>.vvv.>v.>vv..vv.>.>..>.>>....>..v..v>.v>v.>.v>v.......v>>>vv..>v>>..v>.>..>v.>>v...v>...>.v..v>v....v.vv.>..v>vv..
..v...v......>v>.v...v>...>v...>.vv>v...>...>vv..vv.....>..vv....>v.>..v..>....>>v>.vv..>v>v.>>.>v.....>>...v...vv.v..>.>v>.>v>>v.vv>v>.>v.
.>.v.vv..v>>.v..>.v>.>..>v>v....>..>v.v.>..>v.v>>v..>...v...>v.v>v...>v>.>v>.....v..v.v>.v.v.v..v...v..v.>.>vv>.v..v>v.v..vv>.>>vv.v...>...
..>.v.>..>vv.v....>.>.v.>>..>v.>..>>.>.......>.v.v>>.>......>>...v......v...v.vv.v>..v.>>v>>v>v>v.....>vvv.>>.>.>v..v>>.>...>.v...vv..>>v..
>.>vvvv>.v..v>..v..vv....v.>v.>vv.v....v.>v.>v..>.vvv..v>.vv>..v..vvv.v..v..>..>..v...>>..>..>..v>vv.v>>vv>.v.vv.>..>..>v.v.>.v.....v.>>.v>
>vv.v.>..>.>.>v>>>>.>.v.v......v>>>..>.....>v...v>.>>>.>>>.vv..v.........>........v....v.>>....>>vvv.>>..>..v>..v...vv.>>..>.>...>>>>..>...
vv..v...>.....v.....v.v.v..>>>.>>..>v>.>>..>v..>..>vv.v...v..>.>.......v>>>vv.>.v.>....>..>vvvvv..v..v>>v..v>.>>>.v..v...v>....>v...v.v..>>
.v.>>...>.>..v.v...>v.v.>...>>vv.vv.v.>>.v...v..v..>.>...>>.....v>>.v>v.v>>..>....v.v.>.vv.>>v.>>v..v>..>.v>>.>v...v.>>v.>..>..v..v>>v.v>vv
v.>v...v.>.v...>vvv.>>...v..v>.vv>v.v.>.>v..v>v..>.v.>.>.vv>...>......>.>>v>>v.vv...>....>.>>...v>>.v..v>.>......v.v.v>..>.....v.>>v>v.>.>v
.v>>v.>..>..v>...v>...vvv.v....v.v.>>.v.>..>v.v.>.v>>v>..>.v>..>v...vv..>.v>>>>vv..v..>.>.vv>vv>.v.>.>...v..>v...v...v.v..vvvv.>>>.v>.>v.>v
vv>..vv>>>v>.>..v..vvvv.v>.v.>v.>v.....>v>vv.>.>>>.v.>v..>...>>..v..>>........>.vvvv...vv>..v>v..vv>...>v>v>.v....>.>.>v>...vv..v>>.v>>.v.>
v..>.>........>>.>>>..>..>....vvvv.....>..>vv.v.>...>..v...>>v>v.v.v>>v.>>vvv>...v.>.>.>........vvv>v.>v>>>..>.v>.....v.>vv.v.>v..>.......>
..>vv.v..v..v>>v...v..>>>v>.v>>>vv.>..>v.>>.>..>.vv>>>>>..>..>.vvv.v.>.>>>>v>...>.>...v..v..v.v>.>..>>v.v>...v>.v.>v..>v.>...>.>v..>.....v.";

fn main() {
    let mut cucumbers = INPUT
        .lines()
        .map(|l| {
            l.chars()
                .map(|c| match c {
                    '>' => Some(Cucumber::EAST),
                    'v' => Some(Cucumber::SOUTH),
                    '.' => None,
                    _ => panic!(),
                })
                .collect::<Vec<_>>()
        })
        .collect::<Vec<_>>();
    print_cucumbers(&cucumbers);
    let mut moved = true;
    let mut i = 0;
    while moved {
        (moved, cucumbers) = step(&cucumbers);
        i += 1;
    }
    println!("{}", i);
    print_cucumbers(&cucumbers);
}

fn step(cucumbers: &Vec<Vec<Option<Cucumber>>>) -> (bool, Vec<Vec<Option<Cucumber>>>) {
    let mut new_cucumbers = cucumbers.clone();
    let mut moved = false;
    for (y, row) in cucumbers.iter().enumerate() {
        for (x, c) in row.iter().enumerate() {
            if let Some(Cucumber::EAST) = c {
                let x_new = if x == row.len() - 1 { 0 } else { x + 1 };
                if let None = cucumbers[y][x_new] {
                    new_cucumbers[y][x_new] = c.clone();
                    new_cucumbers[y][x] = None;
                    moved = true;
                }
            }
        }
    }
    let mut new_new_cucumbers = new_cucumbers.clone();
    for (y, row) in new_cucumbers.iter().enumerate() {
        for (x, c) in row.iter().enumerate() {
            if let Some(Cucumber::SOUTH) = c {
                let y_new = if y == new_cucumbers.len() - 1 { 0 } else { y + 1 };
                if let None = new_cucumbers[y_new][x] {
                    new_new_cucumbers[y_new][x] = c.clone();
                    new_new_cucumbers[y][x] = None;
                    moved = true;
                }
            }
        }
    }
    (moved, new_new_cucumbers)
}

fn print_cucumbers(cucumbers: &Vec<Vec<Option<Cucumber>>>) {
    for row in cucumbers.iter() {
        for c in row.iter() {
            if let None = c {
                print!(".");
            } else {
                if let Some(Cucumber::EAST) = c {
                    print!(">");
                } else {
                    print!("v");
                }
            }
        }
        println!();
    }
    println!();
}
